{extend name="pc/common/_base" /}

{block name="title"}
<title>{$category['name']}{if !empty($categoryChild)}-{$categoryChild['name']}{/if}-{$website['title']}</title>
{/block}

{block name="style"}

<link rel="stylesheet" href="{$moduleAttachUrl}/static/components/swiper/swiper.min.css">

<style>

    .category-main {
        padding: 30px 0;
    }

    .banner-box {
        padding: 32px 0;
    }

    .swiper {
        width: 100%;
        position: relative;
        overflow: hidden;
    }

    .swiper-wrapper {
        width: 100%;
    }

    .swiper-wrapper .swiper-slide {
        width: 100%;
    }

    .swiper-wrapper .swiper-slide img {
        width: 100%;
    }

    .swiper-wrapper .swiper-pagination-bullet {
        width: 13px;
        height: 5px;
        border: 1px solid #FFFFFF;
        border-radius: 0;
        box-sizing: border-box;
    }

    .swiper-wrapper .swiper-pagination-bullet-active {
        width: 13px;
        height: 5px;
        background: #ffffff;
        border: 1px solid #FFFFFF;
    }

    .swiper-wrapper .swiper-pagination {
        width: 100%;
        height: 50px;
        line-height: 50px;
        padding: 0 36px;
        box-sizing: border-box;
        text-align: right;
    }

    .swiper-pagination-bullet {
        width: 10px;
        height: 10px;
        border-radius: unset;
        background-color: var(--background-white-color);
        opacity: 0.8;
    }

    .swiper-pagination-bullet-active {
        background-color: var(--background-black-color);
        opacity: 1;
    }
</style>

{/block}

{block name="main"}
<section>

    <!-- 轮播图 -->
    {if !empty($advList)}
    <div class="bk"></div>
    <div class="bgfff banner-box">
        <div class="container">
            <div class="swiper">
                <div class="swiper-wrapper">
                    {volist name="advList" id="row"}
                    <a class="swiper-slide" href="{if !empty($row['link'])}{:url($row['link'])}{else}javascript:;{/if}"><img src="{$row['thumb']}" alt="{$row['title']}" onerror="this.src='{$moduleAttachUrl}/static/images/bk.jpg'"></a>
                    {/volist}
                </div>
                {if count($advList) > 1}
                <div class="swiper-pagination"></div>
                {/if}
            </div>
        </div>
    </div>
    {/if}
    <!-- 轮播图 end -->

    <div class="container">

        <div class="category-main">

            <!-- 内容搜索 -->
            {include file='pc/goods/tpl/head'}
            <!-- 内容搜索 end -->

            <!-- 内容分类 -->
            {if $category['style_type'] == 1}
            {include file='pc/goods/tpl/menu/style1'}
            {elseif $category['style_type'] == 2/}
            {include file='pc/goods/tpl/menu/style2'}
            {elseif $category['style_type'] == 3/}
            {include file='pc/goods/tpl/menu/style3'}
            {/if}
            <!-- 内容分类 end -->

            <!-- 内容列表 -->
            {if !empty($goodsList)}
                {if $category['style_type'] == 1}
                {include file='pc/goods/tpl/list/style1'}
                {elseif $category['style_type'] == 2/}
                {include file='pc/goods/tpl/list/style2'}
                {elseif $category['style_type'] == 3/}
                {include file='pc/goods/tpl/list/style3'}
                {/if}
            {else}
                {include file="pc/common/_empty"/}
            {/if}
            <!-- 内容列表 end -->

            <!-- 分页器 -->
            {include file="pc/common/_pager"/}
            <!-- 分页器 end -->

        </div>

    </div>

</section>

{/block}

{block name="script"}
<script>
    require(['jquery.lazyload'], function () {
        $("img").lazyload({effect: "fadeIn", threshold: 180, failure_limit: 50});
    });

    require(['jquery', 'swiper'], function ($, Swiper) {
        new Swiper('.swiper', {
            autoplay: true, // 自动播放
            speed: 1000, // 滑动速度
            grabCursor: true, // 鼠标小手
            loop: true,
            pagination: {
                el: '.swiper-pagination',
                clickable: true,
            },
            on: {
                init: function () {

                },
                slideChangeTransitionEnd: function () {
                    let activeIndex = this.activeIndex;
                    let url = $(this.slides[activeIndex]).children()[0].getAttribute('src');
                    $(".bk").css('background-image', "url(" + url + ")");
                }
            }
        });
    });
</script>
{/block}