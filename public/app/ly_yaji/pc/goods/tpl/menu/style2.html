<style>
    [v-cloak] {
        display: none;
    }

    .goods-category-block .menu-list {
        background-color: #ffffff;
        padding: 0 25px;
    }

    .goods-category-block .menu-list .menu-item {
        padding: 5px 25px;
        line-height: 46px;
        display: flex;
        align-items: center;
    }

    .goods-category-block .menu-list .menu-item .type {
        color: #999;
        text-align: left;
        width: 70px;
    }

    .goods-category-block .menu-list .menu-item .type.more {
        cursor: pointer;
    }

    .goods-category-block .menu-list .menu-item .type-value {
        flex: 1;
        width: 0;
        font-size: 0;
        padding: 5px 0;
        line-height: 36px;
    }

    .goods-category-block .menu-list .menu-item .type-value.moreHide {
        height: 55px;
        overflow: hidden;
    }

    .goods-category-block .menu-list .menu-item .type-value.hide-label {
        height: 36px;
        overflow-y: hidden;
    }

    .goods-category-block .menu-list .menu-item .type-value .value-item {
        display: inline-block;
        margin-right: 45px;
        font-size: 14px;
        color: #919191;
    }

    .goods-category-block .menu-list .menu-item .type-value .value-item.active, .goods-category-block .menu-list .menu-item .type-value .value-item:hover {
        color: var(--primary-color);
    }

    .goods-category-block .menu-list .menu-item .type-value.box .value-item {
        width: 120px;
        height: 36px;
        border-radius: 4px;
        border: 1px solid var(--border-base-color);
        text-align: center;
        overflow: hidden;
        margin-right: 30px;
        padding: 0 10px;
        box-sizing: border-box;
    }

    .goods-category-block .menu-list .menu-item .type-value.box .value-item.active, .goods-category-block .menu-list .menu-item .type-value.box .value-item:hover {
        border: 1px solid var(--primary-color);
    }

    .goods-category-block .all-label {
        border-bottom: 1px solid var(--border-divider-color);
    }

    .goods-category-block .all-sort {
        /*margin-top: 16px;*/
    }

    .goods-category-block .all-category {
        padding-top: 20px;
        border-bottom: 1px solid var(--border-divider-color);
    }
</style>

<div class="goods-category-block" id="js-menu-search" v-cloak>

    <!-- 子分类 -->
    {if !empty($childrenCategory)}
    <div class="menu-list all-category">
        <div class="menu-item" style="align-items: start;">
            <div class="type">类别</div>
            <div class="type-value box" {if empty($ccateid)}:class="showCategoryListMore ? '' : 'moreHide'"{/if}>
                <a href="{:url('gcate/' . $id,['order_by' => $orderBy])}" class="value-item {if $ccateid == ''}active{/if}">全部</a>
                {foreach $childrenCategory as $key => $item}
                <a href="{:url('gcate/' . $id,['ccateid' => $item['id'],'order_by' => $orderBy])}" class="value-item {if $ccateid == $item['id']}active{/if} text-over">{$item['name']}</a>
                {/foreach}
            </div>
            {if count($childrenCategory) > 7}
            <div class="type more" @click="showParentList()" >更多<i class="icon iconfont" style="font-size: 10px;">&#xe68d;</i></div>
            {/if}
        </div>
    </div>
    {/if}

    <!-- 排序 -->
    <div class="menu-list all-sort">
        <div class="menu-item" style="align-items: start;">
            <div class="type">排序</div>
            <div class="type-value">
                <a href="{:url('gcate/' . $id,['ccateid' => $ccateid])}" class="value-item {if $orderBy == ''}active{/if}">默认</a>
                <a href="{:url('gcate/' . $id,['order_by' => 'hot','ccateid' => $ccateid])}" class="value-item {if $orderBy == 'hot'}active{/if}">畅销</a>
                <a href="{:url('gcate/' . $id,['order_by' => 'create','ccateid' => $ccateid])}" class="value-item {if $orderBy == 'create'}active{/if}">创建时间</a>
                <a href="{:url('gcate/' . $id,['order_by' => 'update','ccateid' => $ccateid])}" class="value-item {if $orderBy == 'update'}active{/if}">更新时间</a>
                <a href="{:url('gcate/' . $id,['order_by' => 'price','ccateid' => $ccateid])}" class="value-item {if $orderBy == 'price'}active{/if}">价格</a>
            </div>
        </div>
    </div>

</div>
<script>
    require(['vue', 'h7.axios', 'jquery.gcjs'], (Vue, axios, $) => {

        new Vue({
            el: '#js-menu-search',
            data: {
                ccateid: "{$ccateid}",
                categoryList: [],
                showCategoryListMore: false,
            },
            mounted() {
                // this.getCategoryList()
            },
            methods: {
                showParentList(flag) {
                    this.showCategoryListMore = !this.showCategoryListMore;
                },
                menuBtnSearch(type, value) {
                    location.href = '?' + type + '=' + encodeURIComponent(value);
                },
                getCategoryList() {
                    let url = "{$url}";
                    let id = "{$id}";
                    axios.post(url, {id: id}).then((res) => {
                        this.categoryList = res.childrenCategory || [];
                    });
                }
            }
        });

    });
</script>
